{"version":3,"file":"plugin.min.js","sources":["../src/plugin.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tiny formatting for Moodle\n *\n * @module      tiny_formatting/plugin\n * @copyright   2024, ISB Bayern\n * @author      Dr. Peter Mayer\n * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {component, pluginName} from 'tiny_formatting/common';\nimport {getTinyMCE} from 'editor_tiny/loader';\nimport {getPluginMetadata} from 'editor_tiny/utils';\n\n// Setup the tiny_formatting Plugin.\nconst configureMenu = (menu) => {\n    if (menu.format.items.match(/\\bblocks\\b/)) {\n        menu.format.items = menu.format.items.replace(\n            /(\\bblocks\\b)/,\n            ' styles $1 fontfamily fontsize',\n        );\n    } else {\n        menu.format.items = `${menu.format.items} | fontfamily fontsize`;\n    }\n\n    if (menu.format.items.match(/\\blanguage\\b/)) {\n        menu.format.items = menu.format.items.replace(\n            /(\\blanguage\\b)/,\n            ' forecolor backcolor | $1',\n        );\n    } else {\n        menu.format.items = `${menu.format.items} | forecolor backcolor`;\n    }\n    return menu;\n};\n\n// 'lib/editor/tiny/plugins/formatting/fonts/Grundschulschrift_1.ttf';\n// 'lib/editor/tiny/plugins/formatting/fonts/Handschrift_1.ttf';\n\n// eslint-disable-next-line no-async-promise-executor\nexport default new Promise(async (resolve) => {\n    // Note: The PluginManager.add function does not support asynchronous configuration.\n    // Perform any asynchronous configuration here, and then call the PluginManager.add function.\n    const [\n        tinyMCE,\n        pluginMetadata,\n    ] = await Promise.all([\n        getTinyMCE(),\n        getPluginMetadata(component, pluginName),\n    ]);\n\n    // Reminder: Any asynchronous code must be run before this point.\n    tinyMCE.PluginManager.add(pluginName, () => {\n        // Return the pluginMetadata object. This is used by TinyMCE to display a help link for your plugin.\n        return pluginMetadata;\n    });\n    resolve([pluginName, {\n        configure: (instanceConfig) => ({\n            menu: configureMenu(instanceConfig.menu),\n            content_style: \"@font-face {\\n\" +\n                \"  font-family: Grundschulschrift_1;\\n\" +\n                \"  src: url('/lib/editor/tiny/plugins/formatting/fonts/Grundschulschrift_1.ttf');\\n\" +\n                \"} body { font-family: Grundschulschrift_1; }\",\n            font_family_formats: \"Grundschulschrift_1=Grundschulschrift_1; Andale Mono=andale mono,times; Arial=arial,helvetica,sans-serif; Arial Black=arial black,avant garde; Book Antiqua=book antiqua,palatino; Comic Sans MS=comic sans ms,sans-serif; Courier New=courier new,courier; Georgia=georgia,palatino; Helvetica=helvetica; Impact=impact,chicago; Symbol=symbol; Tahoma=tahoma,arial,helvetica,sans-serif; Terminal=terminal,monaco; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms,geneva; Verdana=verdana,geneva; Webdings=webdings; Wingdings=wingdings,zapf dingbats\",\n        })\n        }\n    ]);\n});\n"],"names":["Promise","async","tinyMCE","pluginMetadata","all","component","pluginName","PluginManager","add","resolve","configure","instanceConfig","menu","format","items","match","replace","content_style","font_family_formats"],"mappings":"sPAsDe,IAAIA,SAAQC,MAAAA,gBAInBC,QACAC,sBACMH,QAAQI,IAAI,EAClB,yBACA,4BAAkBC,kBAAWC,sBAIjCJ,QAAQK,cAAcC,IAAIF,oBAAY,IAE3BH,iBAEXM,QAAQ,CAACH,mBAAY,CACjBI,UAAYC,wBACRC,MA3CWA,KA2CSD,eAAeC,KA1CvCA,KAAKC,OAAOC,MAAMC,MAAM,cACxBH,KAAKC,OAAOC,MAAQF,KAAKC,OAAOC,MAAME,QAClC,eACA,kCAGJJ,KAAKC,OAAOC,gBAAWF,KAAKC,OAAOC,gCAGnCF,KAAKC,OAAOC,MAAMC,MAAM,gBACxBH,KAAKC,OAAOC,MAAQF,KAAKC,OAAOC,MAAME,QAClC,iBACA,6BAGJJ,KAAKC,OAAOC,gBAAWF,KAAKC,OAAOC,gCAEhCF,MA0BCK,cAAe,oLAIfC,oBAAqB,8iBAhDVN,IAAAA"}